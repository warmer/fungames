SELECT
     MAX((g.attendance))-MIN((g.attendance)), MAX((g.awayDistance))-MIN((g.awayDistance)), MAX((g.homeDistance))-MIN((g.homeDistance)), MAX((log((g.awayDistance+1)*g.attendance)))-MIN((log((g.awayDistance+1)*g.attendance))), MAX((log((g.homeDistance+1)*g.attendance)))-MIN((log((g.homeDistance+1)*g.attendance))), MAX((oppAllow.Ast))-MIN((oppAllow.Ast)), MAX((oppAllow.Blk))-MIN((oppAllow.Blk)), MAX((oppAllow.FGA))-MIN((oppAllow.FGA)), MAX((oppAllow.FGM))-MIN((oppAllow.FGM)), MAX((oppAllow.FTA))-MIN((oppAllow.FTA)), MAX((oppAllow.FTM))-MIN((oppAllow.FTM)), MAX((oppAllow.Off))-MIN((oppAllow.Off)), MAX((oppAllow.PF))-MIN((oppAllow.PF)), MAX((oppAllow.Reb))-MIN((oppAllow.Reb)), MAX((oppAllow.Stl))-MIN((oppAllow.Stl)), MAX((oppAllow.TeamReb))-MIN((oppAllow.TeamReb)), MAX((oppAllow.TPA))-MIN((oppAllow.TPA)), MAX((oppAllow.TPM))-MIN((oppAllow.TPM)), MAX((oppAllow.TRN))-MIN((oppAllow.TRN)), MAX((oppAvg.Ast))-MIN((oppAvg.Ast)), MAX((oppAvg.Blk))-MIN((oppAvg.Blk)), MAX((oppAvg.FGA))-MIN((oppAvg.FGA)), MAX((oppAvg.FGM))-MIN((oppAvg.FGM)), MAX((oppAvg.FTA))-MIN((oppAvg.FTA)), MAX((oppAvg.FTM))-MIN((oppAvg.FTM)), MAX((oppAvg.Off))-MIN((oppAvg.Off)), MAX((oppAvg.PF))-MIN((oppAvg.PF)), MAX((oppAvg.Reb))-MIN((oppAvg.Reb)), MAX((oppAvg.Stl))-MIN((oppAvg.Stl)), MAX((oppAvg.TeamReb))-MIN((oppAvg.TeamReb)), MAX((oppAvg.TPA))-MIN((oppAvg.TPA)), MAX((oppAvg.TPM))-MIN((oppAvg.TPM)), MAX((oppAvg.TRN))-MIN((oppAvg.TRN)), MAX((teamAllow.Ast))-MIN((teamAllow.Ast)), MAX((teamAllow.Blk))-MIN((teamAllow.Blk)), MAX((teamAllow.FGA))-MIN((teamAllow.FGA)), MAX((teamAllow.FGM))-MIN((teamAllow.FGM)), MAX((teamAllow.FTA))-MIN((teamAllow.FTA)), MAX((teamAllow.FTM))-MIN((teamAllow.FTM)), MAX((teamAllow.Off))-MIN((teamAllow.Off)), MAX((teamAllow.PF))-MIN((teamAllow.PF)), MAX((teamAllow.Reb))-MIN((teamAllow.Reb)), MAX((teamAllow.Stl))-MIN((teamAllow.Stl)), MAX((teamAllow.TeamReb))-MIN((teamAllow.TeamReb)), MAX((teamAllow.TPA))-MIN((teamAllow.TPA)), MAX((teamAllow.TPM))-MIN((teamAllow.TPM)), MAX((teamAllow.TRN))-MIN((teamAllow.TRN)), MAX((teamAvg.Ast))-MIN((teamAvg.Ast)), MAX((teamAvg.Blk))-MIN((teamAvg.Blk)), MAX((teamAvg.FGA))-MIN((teamAvg.FGA)), MAX((teamAvg.FGM))-MIN((teamAvg.FGM)), MAX((teamAvg.FTA))-MIN((teamAvg.FTA)), MAX((teamAvg.FTM))-MIN((teamAvg.FTM)), MAX((teamAvg.Off))-MIN((teamAvg.Off)), MAX((teamAvg.PF))-MIN((teamAvg.PF)), MAX((teamAvg.Reb))-MIN((teamAvg.Reb)), MAX((teamAvg.Stl))-MIN((teamAvg.Stl)), MAX((teamAvg.TeamReb))-MIN((teamAvg.TeamReb)), MAX((teamAvg.TPA))-MIN((teamAvg.TPA)), MAX((teamAvg.TPM))-MIN((teamAvg.TPM)), MAX((teamAvg.TRN))-MIN((teamAvg.TRN))
    
FROM
    tblgames AS g,
    tblteamgameaverages AS teamAvg,
    tblteamgameaverages AS oppAvg,
    tblteamgameavgopptendencies as teamAllow,
    tblteamgameavgopptendencies as oppAllow
WHERE 
    (ROUND(DEGREES(gameID)) % 100) < (100 - 0) AND
    g.homeTeamYahooID=teamAvg.teamID AND
    g.visitingTeamYahooID=oppAvg.teamID AND
    g.homeTeamYahooID=teamAllow.teamID AND
    g.visitingTeamYahooID=oppAllow.teamID AND
    teamAllow.Home = 2 AND
    oppAllow.Home = 2 AND
    g.homeTeamYahooID != "" AND
    g.visitingTeamYahooID != "" AND
    g.homeDistance is not null AND
    g.awayDistance is not null AND
    g.date > 2013-01-01 AND
    g.attendance > 0

;


SELECT
     ((g.attendance)-5187.5214)/4920.7612, ((g.awayDistance)-813.939761005333)/930.790035681376, ((g.homeDistance)-112.617623968441)/631.44365317959, ((log((g.awayDistance+1)*g.attendance))-14.245810754979)/1.70639021003714, ((log((g.homeDistance+1)*g.attendance))-8.60790415162866)/1.99831779365165, ((oppAllow.Ast)-0.0949271242607524)/0.95736241673227, ((oppAllow.Blk)-0.00650246869246772)/0.382794751873983, ((oppAllow.FGA)--0.0315428431358)/1.26403338266285, ((oppAllow.FGM)-0.127763049180468)/0.9000401927475, ((oppAllow.FTA)-0.107092539174673)/1.47118090813696, ((oppAllow.FTM)-0.110267192385319)/1.12761102374571, ((oppAllow.Off)-0.0149711091794242)/0.493260975362941, ((oppAllow.PF)--0.119778543489543)/0.784753796088739, ((oppAllow.Reb)-0.113140592629447)/1.03261157656206, ((oppAllow.Stl)-0.0360928593812051)/0.463660010479098, ((oppAllow.TeamReb)-0)/0, ((oppAllow.TPA)--0.0179381849774441)/0.969700033868348, ((oppAllow.TPM)-0.036122769905358)/0.494040116485371, ((oppAllow.TRN)-0.0060565462757382)/0.726279357537089, ((oppAvg.Ast)-12.6971184385875)/1.7632700955077, ((oppAvg.Blk)-3.60363456490593)/1.12706432271378, ((oppAvg.FGA)-55.3865190094746)/3.14069620540813, ((oppAvg.FGM)-24.4477618520999)/1.91471931343234, ((oppAvg.FTA)-22.4374642783367)/2.85700841538533, ((oppAvg.FTM)-15.6644341721427)/2.13050933008447, ((oppAvg.Off)-9.28290997070454)/1.54924452530417, ((oppAvg.PF)-19.2121614673544)/1.7789122946155, ((oppAvg.Reb)-31.4983839575515)/2.60499112218197, ((oppAvg.Stl)-6.17923565659924)/1.14242285469307, ((oppAvg.TeamReb)--1)/0, ((oppAvg.TPA)-18.261571434538)/2.97759123849128, ((oppAvg.TPM)-6.3084693125386)/1.24554404297444, ((oppAvg.TRN)-12.1670172244861)/1.45087256667228, ((teamAllow.Ast)-0.0368989338197191)/0.916243842882306, ((teamAllow.Blk)--0.0103705021620272)/0.362341679004938, ((teamAllow.FGA)-0.0506598466067471)/1.1789929092916, ((teamAllow.FGM)-0.0289153880712211)/0.849828021429397, ((teamAllow.FTA)--0.0611579794642273)/1.40236292849714, ((teamAllow.FTM)--0.0360191242119156)/1.06023435505374, ((teamAllow.Off)-0.00526154110097236)/0.45531272372074, ((teamAllow.PF)--0.0655975919170975)/0.726861966427984, ((teamAllow.Reb)-0.0353536947496958)/0.986521094859508, ((teamAllow.Stl)-0.00964113448529299)/0.435006020446428, ((teamAllow.TeamReb)-0)/0, ((teamAllow.TPA)-0.0424043847012259)/0.91039751101852, ((teamAllow.TPM)-0.0262928385946184)/0.466938611427371, ((teamAllow.TRN)-0.0375893132483828)/0.667247674254181, ((teamAvg.Ast)-12.8458327138693)/1.78744755701218, ((teamAvg.Blk)-3.7295541652419)/1.14758298628419, ((teamAvg.FGA)-55.4403234133241)/3.09480225387264, ((teamAvg.FGM)-24.578451508712)/1.8661803175702, ((teamAvg.FTA)-22.5969429133609)/2.80192970929827, ((teamAvg.FTM)-15.7703523957019)/2.08687426322831, ((teamAvg.Off)-9.38914579865379)/1.56871922427565, ((teamAvg.PF)-19.0647361753413)/1.76887866477085, ((teamAvg.Reb)-31.8312909096908)/2.58710275739662, ((teamAvg.Stl)-6.18900123411136)/1.18505038438325, ((teamAvg.TeamReb)--1)/0, ((teamAvg.TPA)-18.168554069472)/2.93266388977106, ((teamAvg.TPM)-6.29861896380752)/1.23966631631765, ((teamAvg.TRN)-12.0136516870659)/1.43302991687644
    , CAST(g.homeScore - g.visitingScore AS signed) AS margin
FROM
    tblgames AS g,
    tblteamgameaverages AS teamAvg,
    tblteamgameaverages AS oppAvg,
    tblteamgameavgopptendencies as teamAllow,
    tblteamgameavgopptendencies as oppAllow
WHERE
    (ROUND(DEGREES(gameID)) % 100) < (100 - 0) AND
    g.homeTeamYahooID=teamAvg.teamID AND
    g.visitingTeamYahooID=oppAvg.teamID AND
    g.homeTeamYahooID=teamAllow.teamID AND
    g.visitingTeamYahooID=oppAllow.teamID AND
    teamAllow.Home = 2 AND
    oppAllow.Home = 2 AND
    g.homeTeamYahooID != "" AND
    g.visitingTeamYahooID != "" AND
    g.homeDistance is not null AND
    g.awayDistance is not null AND
    g.date > 2013-01-01 AND
    g.attendance > 0
GROUP BY teamAllow.teamID, oppAllow.teamID, teamAvg.teamID, oppAvg.teamID, g.gameID
;
SELECT * FROM tblteams WHERE yahooID='scf';
SELECT * FROM tblmodel;

SELECT * FROM tblteamgameavgopptendencies_2013;
SELECT * FROM tblmodel_2013;

INSERT INTO tblfeatures (modelID,version,featureName,weight,average,vrange,deviation) VALUES (8,1,"(g.attendance)",1.275538,5187.5214,35344,4920.7612),(8,1,"(g.awayDistance)",0.280411,813.939761005333,8546.69140625,930.790035681376),(8,1,"(g.homeDistance)",-0.3021539,112.617623968441,8187.66796875,631.44365317959),(8,1,"(log((g.awayDistance+1)*g.attendance))",0.7383104,14.245810754979,12.4722141416993,1.70639021003714),(8,1,"(log((g.homeDistance+1)*g.attendance))",-0.6902739,8.60790415162866,13.362396062695,1.99831779365165),(8,1,"(oppAllow.Ast)",0.5354966,0.0949271242607524,7.26004838943481,0.95736241673227),(8,1,"(oppAllow.Blk)",-0.1443729,0.00650246869246772,4.3096137046814,0.382794751873983),(8,1,"(oppAllow.FGA)",-2.590238,-0.0315428431358,11.0447115898132,1.26403338266285),(8,1,"(oppAllow.FGM)",1.901153,0.127763049180468,5.57656693458557,0.9000401927475),(8,1,"(oppAllow.FTA)",-0.9161465,0.107092539174673,8.06417226791382,1.47118090813696),(8,1,"(oppAllow.FTM)",1.372114,0.110267192385319,6.23018479347229,1.12761102374571),(8,1,"(oppAllow.Off)",0.08570386,0.0149711091794242,3.23357391357422,0.493260975362941),(8,1,"(oppAllow.PF)",-0.5638282,-0.119778543489543,6.16209292411804,0.784753796088739),(8,1,"(oppAllow.Reb)",1.884416,0.113140592629447,8.14656019210815,1.03261157656206),(8,1,"(oppAllow.Stl)",0.4511992,0.0360928593812051,3.28512418270111,0.463660010479098),(8,1,"(oppAllow.TPA)",0.1034127,-0.0179381849774441,7.10878610610962,0.969700033868348),(8,1,"(oppAllow.TPM)",0.1393115,0.036122769905358,5.14673697948456,0.494040116485371),(8,1,"(oppAllow.TRN)",-1.103982,0.0060565462757382,5.34889960289001,0.726279357537089),(8,1,"(oppAvg.Ast)",-1.14262,12.6971184385875,10.7954540252686,1.7632700955077),(8,1,"(oppAvg.Blk)",-0.3297684,3.60363456490593,6.4637097120285,1.12706432271378),(8,1,"(oppAvg.FGA)",2.881457,55.3865190094746,24.0786285400391,3.14069620540813),(8,1,"(oppAvg.FGM)",-1.06706,24.4477618520999,11.6686229705811,1.91471931343234),(8,1,"(oppAvg.FTA)",1.463188,22.4374642783367,16.3810482025146,2.85700841538533),(8,1,"(oppAvg.FTM)",-1.021359,15.6644341721427,11.890477180481,2.13050933008447),(8,1,"(oppAvg.Off)",-0.2142933,9.28290997070454,10.0725803375244,1.54924452530417),(8,1,"(oppAvg.PF)",-0.4783228,19.2121614673544,10.5151519775391,1.7789122946155),(8,1,"(oppAvg.Reb)",-2.49675,31.4983839575515,17.7409591674805,2.60499112218197),(8,1,"(oppAvg.Stl)",-1.21306,6.17923565659924,7.91840624809265,1.14242285469307),(8,1,"(oppAvg.TPA)",0.3022304,18.261571434538,17.6612911224365,2.97759123849128),(8,1,"(oppAvg.TPM)",-1.250578,6.3084693125386,7.3323860168457,1.24554404297444),(8,1,"(oppAvg.TRN)",2.938435,12.1670172244861,8.79720306396484,1.45087256667228),(8,1,"(teamAllow.Ast)",-0.3961285,0.0368989338197191,7.26004838943481,0.916243842882306),(8,1,"(teamAllow.Blk)",-0.1599047,-0.0103705021620272,4.3096137046814,0.362341679004938),(8,1,"(teamAllow.FGA)",0.817991,0.0506598466067471,9.48401665687561,1.1789929092916),(8,1,"(teamAllow.FGM)",-0.7254087,0.0289153880712211,7.08734273910522,0.849828021429397),(8,1,"(teamAllow.FTA)",-0.3049398,-0.0611579794642273,8.06417226791382,1.40236292849714),(8,1,"(teamAllow.FTM)",-0.687682,-0.0360191242119156,6.23018479347229,1.06023435505374),(8,1,"(teamAllow.Off)",0.4465923,0.00526154110097236,3.23357391357422,0.45531272372074),(8,1,"(teamAllow.PF)",0.6910496,-0.0655975919170975,6.16209292411804,0.726861966427984),(8,1,"(teamAllow.Reb)",-1.294567,0.0353536947496958,6.91862916946411,0.986521094859508),(8,1,"(teamAllow.Stl)",-0.423701,0.00964113448529299,3.09463810920715,0.435006020446428),(8,1,"(teamAllow.TPA)",0.07642136,0.0424043847012259,6.83130621910095,0.91039751101852),(8,1,"(teamAllow.TPM)",-0.3886337,0.0262928385946184,5.14673697948456,0.466938611427371),(8,1,"(teamAllow.TRN)",0.8090801,0.0375893132483828,5.34889960289001,0.667247674254181),(8,1,"(teamAvg.Ast)",0.6338378,12.8458327138693,10.7954540252686,1.78744755701218),(8,1,"(teamAvg.Blk)",0.5573128,3.7295541652419,6.4637097120285,1.14758298628419),(8,1,"(teamAvg.FGA)",-3.16771,55.4403234133241,24.0786285400391,3.09480225387264),(8,1,"(teamAvg.FGM)",1.449159,24.578451508712,11.6686229705811,1.8661803175702),(8,1,"(teamAvg.FTA)",-1.302074,22.5969429133609,16.3810482025146,2.80192970929827),(8,1,"(teamAvg.FTM)",1.242796,15.7703523957019,11.890477180481,2.08687426322831),(8,1,"(teamAvg.Off)",-0.3054182,9.38914579865379,10.0725803375244,1.56871922427565),(8,1,"(teamAvg.PF)",0.697594,19.0647361753413,10.5151519775391,1.76887866477085),(8,1,"(teamAvg.Reb)",3.350082,31.8312909096908,17.7409591674805,2.58710275739662),(8,1,"(teamAvg.Stl)",1.873323,6.18900123411136,8.17647075653076,1.18505038438325),(8,1,"(teamAvg.TPA)",-0.6251888,18.168554069472,17.6612911224365,2.93266388977106),(8,1,"(teamAvg.TPM)",1.626437,6.29861896380752,7.63541698455811,1.23966631631765),(8,1,"(teamAvg.TRN)",-2.434153,12.0136516870659,8.79720306396484,1.43302991687644);